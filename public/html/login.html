<!DOCTYPE html>
<html lang="en">
    <head>
        <title>login</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="../stylesheets/style.css" rel="stylesheet">
    </head>
    <body>
        <h2>login</h2>
        <form>    
            <div>
                <span>username: </span>
                <input type="text"name="username" value="">
            </div>
            <div>
                <span> password: </span>
                <input type="text" name="password" value="">
            </div>
            <div>
                <button type="button" id="login_btn">login in</button>
            </div>
        </form>

        <script>
            function getDate(a) {
                // console.log(a)
                let name = document.getElementsByName('username')[0].value;
                let password = document.getElementsByName('password')[0].value;

                // POST请求
                let req = new XMLHttpRequest();
                // OPEN
                req.open('POST', '/user/login');
                // req.open('POST', '/user/create_user');
                // 设置请求头部信息
                req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                // 指定服务端返回的数据类型
                req.responseType = 'json';
                // 发起请求
                req.send('username=' + name + '&password=' + password);

                // 添加监听事件
                req.onload = function (e) {
                    if (this.status === 200) {
                        // 获取服务端返回的数据this.response
                        console.log("this.response chenggong");
                        if (this.response.code === 200) {
                            alert("this.response chenggong");
                            //重定向
                            // window.location.href='index.html';
                            let data = this.response.data;
                            console.log(data);
                        } else {
                            alert("cuo wu");
                        }
                    } else {
                        alert('网络错误');
                    }
                }

            }

            // var lala = {
            //     "name": "zhangchi",
            //     "age": "1234"
            // }
            // let btn = document.getElementById('login_btn');
            // btn.setAttribute('onclick', `getDate('${lala["name"]}')`);
            for(let i = 0; i < 3; i ++){
                console.log(i)
                document.getElementById("login_btn").onclick = function () {
                    console.log(`shi wo ${i}`)
                    console.log(document.getElementById("login_btn").onclick)
                    // getDate(a);
                };
            }

            // document.getElementById("login_btn").onclick = function (b) {
            //     console.log(`shi wo ${b}`)
            //     getDate(a);
            // };
                
            // 登录后向createArticle发数据新建文章
            // let category_name = "javascript笔记";
            //         let title = "javascript lalalal";
            //         let content = "lalalalalalalallaaaaa"
            //          // POST请求
            //         let req = new XMLHttpRequest();
            //         // OPEN
            //         req.open('POST', '/articles/createArticle');
            //         // req.open('POST', '/user/create_user');
            //         // 设置请求头部信息
            //         req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
            //         // 指定服务端返回的数据类型
            //         req.responseType = 'json';
            //         // 发起请求
            //         req.send('category_name=' + category_name + '&title=' + title + '&content=' + content);

            //         // 添加监听事件
            //         req.onload = function (e) {
            //             if (this.status === 200) {
            //                 // 获取服务端返回的数据this.response
            //                 console.log(this.response.code);
            //                 if (this.response.code === 200) {
            //                     alert("article chenggong");
            //                     //重定向
            //                     // window.location.href='index.html';
            //                     let data = this.response.data;
            //                     console.log(data);
            //                 } else {
            //                     alert("cuo wu");
            //                 }
            //             } else {
            //                 alert('网络错误');
            //             }
            //         }
        </script>
    </body>
</html>